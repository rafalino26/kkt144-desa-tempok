generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "postgresql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

/* =======================
   AUTH / USER / POST
   ======================= */

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  nama         String
  passwordHash String
  createdAt    DateTime @default(now())
}

model Post {
  id        String   @id @default(cuid())
  title     String
  content   String   @db.Text
  published Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

/* Konten halaman umum (hero home dsb) */
model PageContent {
  id        String   @id @default(cuid())
  slug      String   @unique
  content   String   @db.Text
  updatedAt DateTime @updatedAt
}

/* Statistik kependudukan ringkas (Home -> Sekilas Info) */
model Statistik {
  id               String   @id @default(cuid())

  jumlahPenduduk   Int
  updatedPenduduk  DateTime @default(now())

  jumlahKK         Int      @default(0)
  updatedKK        DateTime @default(now())

  luasWilayah      Float
  updatedWilayah   DateTime @default(now())

  jumlahDusun      Int      @default(0)
  updatedDusun     DateTime @default(now())

  updatedAt        DateTime @updatedAt
}

/* Snapshot profesi penduduk untuk grafik pie */
model ProfesiSnapshot {
  id          String   @id @default(cuid())
  // contoh: [{ "name": "Petani", "value": 120 }, ...]
  items       Json?    
  capturedAt  DateTime @default(now())
}

/* =======================
   PROFIL DESA SECTION
   ======================= */

/* Hero section halaman /profil */
model ProfilHero {
  id        String   @id @default(cuid())
  title     String
  subtitle  String   @db.Text
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

/* Identitas desa (data administratif) */
model ProfilIdentitas {
  id             String   @id @default(cuid())

  namaDesa       String
  kecamatan      String
  kabupaten      String
  provinsi       String

  kodePos        String?
  kodeKemendagri String?

  koordinat      String?
  kepalaDesa     String?

  catatan        String?   @db.Text

  updatedAt      DateTime  @updatedAt
  createdAt      DateTime  @default(now())
}

/* Visi & Misi */
model ProfilVisiMisi {
  id        String   @id @default(cuid())
  visi      String   @db.Text
  misi      Json     // ["Mendorong ...", "Meningkatkan ..."]
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

/* Sejarah Desa */
model ProfilSejarah {
  id        String   @id @default(cuid())
  content   String   @db.Text
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

/* Geografis & batas wilayah */
model ProfilGeografis {
  id              String   @id @default(cuid())

  deskripsiLokasi String   @db.Text
  batasUtara      String?
  batasTimur      String?
  batasSelatan    String?
  batasBarat      String?

  googleMapsUrl   String?

  updatedAt       DateTime @updatedAt
  createdAt       DateTime @default(now())
}

/* Struktur pemerintah desa (bisa banyak row) */
model ProfilPerangkatDesa {
  id        String   @id @default(cuid())

  nama      String
  jabatan   String
  urutan    Int      // buat sorting di UI

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
}

/* Sosial & Ekonomi */
model ProfilSosialEkonomi {
  id                        String   @id @default(cuid())

  ringkasan                 String   @db.Text
  mataPencaharian           String?
  sektorPendukung           String?
  catatan                   String?  @db.Text

  jumlahPendudukTekstual    String?
  catatanPenduduk           String?

  updatedAt                 DateTime @updatedAt
  createdAt                 DateTime @default(now())
}
